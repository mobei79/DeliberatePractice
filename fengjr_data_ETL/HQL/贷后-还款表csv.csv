createtab_stmt
CREATE EXTERNAL TABLE `dwi.dwi_ordr_p2p_asset_repay_info_full`(
"  `income_no` string COMMENT '进件号，北京：进件号；深圳form_id\;机构：合同号', "
"  `loan_id` string COMMENT '贷款编号', "
"  `user_id` string COMMENT 'user_id', "
"  `mobile_md5` string COMMENT 'md5加密手机号', "
"  `id_card_md5` string COMMENT 'md5加密身份证号', "
"  `org_id` string COMMENT '机构号', "
"  `org_name` string COMMENT '机构号名称', "
"  `due_period_cnt` int COMMENT '到期期数/进入表现期期数', "
"  `total_periods` int COMMENT '总期数', "
"  `total_capital_amt` decimal(24,4) COMMENT '总本金', "
"  `his_overdue_cnt` int COMMENT '逾期总期数', "
"  `his_overdue_d3_cnt` int COMMENT 'D3+逾期次数', "
"  `his_overdue_d15_cnt` int COMMENT 'D15+逾期次数', "
"  `his_overdue_m1_cnt` int COMMENT 'm1+逾期次数', "
"  `his_overdue_m2_cnt` int COMMENT 'm2+逾期次数', "
"  `his_overdue_m3_cnt` int COMMENT 'm3+逾期次数', "
"  `his_overdue_m6_cnt` int COMMENT 'm6+逾期次数', "
"  `his_overdue_amt` decimal(24,4) COMMENT '逾期总金额', "
"  `his_overdue_d3_amt` decimal(24,4) COMMENT 'D3+逾期金额', "
"  `his_overdue_d15_amt` decimal(24,4) COMMENT 'D15+逾期金额', "
"  `his_overdue_m1_amt` decimal(24,4) COMMENT 'm1+逾期金额', "
"  `his_overdue_m2_amt` decimal(24,4) COMMENT 'm2+逾期金额', "
"  `his_overdue_m3_amt` decimal(24,4) COMMENT 'm3+逾期金额', "
"  `his_overdue_m6_amt` decimal(24,4) COMMENT 'm6+逾期金额', "
"  `his_overdue_cnt_6m` int COMMENT '最近6个月逾期总期数', "
"  `his_overdue_d3_cnt_6m` int COMMENT '最近6个月D3+逾期次数', "
"  `his_overdue_d15_cnt_6m` int COMMENT '最近6个月D15+逾期次数', "
"  `his_overdue_m1_cnt_6m` int COMMENT '最近6个月m1+逾期次数', "
"  `his_overdue_m2_cnt_6m` int COMMENT '最近6个月m2+逾期次数', "
"  `his_overdue_m3_cnt_6m` int COMMENT '最近6个月m3+逾期次数', "
"  `his_overdue_amt_6m` decimal(24,4) COMMENT '最近6个月逾期金额', "
"  `his_overdue_d3_amt_6m` decimal(24,4) COMMENT '最近6个月D3+逾期金额', "
"  `his_overdue_d15_amt_6m` decimal(24,4) COMMENT '最近6个月D15+逾期金额', "
"  `his_overdue_m1_amt_6m` decimal(24,4) COMMENT '最近6个月m1+逾期金额', "
"  `his_overdue_m2_amt_6m` decimal(24,4) COMMENT '最近6个月m2+逾期金额', "
"  `his_overdue_m3_amt_6m` decimal(24,4) COMMENT '最近6个月m3+逾期金额', "
"  `his_overdue_cnt_12m` int COMMENT '最近12个月逾期总期数', "
"  `his_overdue_d3_cnt_12m` int COMMENT '最近12个月D3+逾期次数', "
"  `his_overdue_d15_cnt_12m` int COMMENT '最近12个月D15+逾期次数', "
"  `his_overdue_m1_cnt_12m` int COMMENT '最近12个月m1+逾期次数', "
"  `his_overdue_m2_cnt_12m` int COMMENT '最近12个月m2+逾期次数', "
"  `his_overdue_m3_cnt_12m` int COMMENT '最近12个月m3+逾期次数', "
"  `his_overdue_m6_cnt_12m` int COMMENT '最近12个月m6+逾期次数', "
"  `his_overdue_amt_12m` decimal(24,4) COMMENT '最近12个月逾期总金额', "
"  `his_overdue_d3_amt_12m` decimal(24,4) COMMENT '最近12个月D3+逾期金额', "
"  `his_overdue_d15_amt_12m` decimal(24,4) COMMENT '最近12个月D15+逾期金额', "
"  `his_overdue_m1_amt_12m` decimal(24,4) COMMENT '最近12个月m1+逾期金额', "
"  `his_overdue_m2_amt_12m` decimal(24,4) COMMENT '最近12个月m2+逾期金额', "
"  `his_overdue_m3_amt_12m` decimal(24,4) COMMENT '最近12个月m3+逾期金额', "
"  `his_overdue_m6_amt_12m` decimal(24,4) COMMENT '最近12个月m6+逾期金额', "
"  `cur_aging` int COMMENT '当前逾期账龄', "
"  `cur_overdue_days` int COMMENT '当前逾期天数', "
"  `cur_overdue_amt` decimal(24,4) COMMENT '当前逾期金额', "
"  `max_his_overdue_days` int COMMENT '历史最大逾期天数', "
"  `max_his_overdue_aging` int COMMENT '历史最大逾期账龄', "
"  `max_his_overdue_days_6m` int COMMENT '最近6个月最大逾期天数', "
"  `max_his_overdue_aging_6m` int COMMENT '最近6个月历史最大逾期账龄', "
"  `max_his_overdue_days_12m` int COMMENT '最近12个月最大逾期天数', "
"  `max_his_overdue_aging_12m` int COMMENT '最近12个月历史最大逾期账龄', "
"  `bal_capital_amt` decimal(24,4) COMMENT '剩余在贷本金', "
"  `repay_capital_amt` decimal(24,4) COMMENT '已还本金', "
"  `overdue_settle_amt` decimal(24,4) COMMENT '逾期后已经本金', "
"  `overdue_settle_cnt` int COMMENT '历史逾期已还期数', "
"  `due_amt_1m` decimal(24,4) COMMENT '未来1个月待还本金', "
"  `due_amt_3m` decimal(24,4) COMMENT '未来3个月待还本金', "
"  `due_amt_6m` decimal(24,4) COMMENT '未来6个月待还本金', "
"  `due_amt_12m` decimal(24,4) COMMENT '未来12个月待还本金', "
"  `max_normal_payment_period` int COMMENT '最长连续正常还款期数', "
"  `max_overdue_payment_period` int COMMENT '最长连续逾期后还款期数', "
"  `min_due_days` int COMMENT '最近还款日距今日期', "
"  `his_overdue_d7_cnt` int COMMENT 'D7+逾期次数', "
"  `his_overdue_d7_amt` int COMMENT 'D7+逾期次数', "
"  `repay_period_cnt` int COMMENT '已还期数', "
"  `repay_status` string COMMENT '还款状态', "
"  `min_due_tm` string COMMENT '最小应还日期', "
  `max_due_tm` string COMMENT '最大应还日期')
COMMENT '贷后-还款表'
PARTITIONED BY ( 
"  `dt` string, "
  `business_source` string COMMENT '业务系统来源，bj:北京；sz:深圳；org:机构')
ROW FORMAT SERDE 
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  'hdfs://feng-cluster/user/hive/warehouse/dwi.db/dwi_ordr_p2p_asset_repay_info_full'
TBLPROPERTIES (
"  'parquet.compression'='SNAPPY', "
  'transient_lastDdlTime'='1555914543')
